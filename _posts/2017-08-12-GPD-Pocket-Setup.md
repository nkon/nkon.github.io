---
layout: post
title: GPD Pocket の環境整備
category: blog
tags: gpd_pocket windows10 bash_on_windows docker docker_for_windows rust python
---

GPD Pocket を購入したので設定メモ。Windows10を使うのも初めてということもあり、前半はGPD Pocket 特有の話も書いてあるが、後半はWindows10の環境構築の話がメインになってしまった。

# 初期設定
Wiki(http://gpd.wiki)[http://gpd.wiki] ができて情報が集約されているので、まずはそちらを参照する。
* Windows Update
* Wifi driverの更新
* その他、デバイスマネージャからデバイスドライバの更新(できるものは)


# 処理能力
* マルチタスク的な状況だと重さを感じる。たとえば、ブラウザを起動して複数のページを処理しているときとか、Facebookのウェブページとか。
* タスクマネージャで見るとCPU は4つ見える。

## 既知の不具合と対策
* 蓋を閉じているのにスリープから覚める→ホールセンサの異常が疑われる。レジストリを編集して設定を出し、蓋を開いたときの動作を「何もしない」にする。
* スリープ時に勝手に覚める→スリープから休止状態になろうとして失敗して起動してしまう。
    + 休止状態の削除(powercfg /hibernate off'): たぶん初期設定でそうなっていると思うが、何かの拍子に有効になっていたら。
    + Wifiドライバの手動更新。
    + レジストリを編集して設定を出し、IO一体化タイムアウトの設定を変更する。
* System task が30%ほど電力を食い続ける→Intel DPTF ドライバの不良。最新のWindows Update で直っている(8.3.10205.4743 [2017/06/22])？
* 30%以上にCPUが回らない→BIOSの不具合？ 2017/07/03より以前のBIOSにすれば治る？ 2017-08-16時点では対策中？ 熱すぎることが原因なので、そうなったら電源を切って冷ますしかない？
    + 休止状態の削除。BTマウスが動いてしまうとスリープから解除されてしまうので、忘れずにマウスの電源を切る。または、トラックポイントに慣れよう。
* イヤホンマイクを使ったときに正常に聞こえない→2017-08-11のサウンドドライバ更新で改善した。

# バッテリー＆スリープ
MIROさんの記事に従ってレジストリを編集し、電源オプションでカバーを開いたときのアクションを設定できるようにして「何もしない」にすればOK。ちゃんとスリープ(メモリを保持)＆休止(ディスクにメモリを書き出す)してくれるし、ちょっと使いには十分バッテリーが持つ。3時間ぐらいが実用か？
スリープから勝手に起動してしまう場合はWifiドライバの手動更新と、IO一体化タイムアウトのレジストリ編集で治ると思う。
休止からの復帰は、上述の30% 問題があるので、スリープでの運用が推奨されている。

ただし、Bluetooth接続のマウスを使っている場合、マウスを動かすとスリープが解除されてしまう。スリープ前にマウスの電源をOFFにするのを忘れないようにしよう。


## スリープのコツ

現在の設定でスリープ時の消費電力は17mW。これなら数日は持つ。

* WiFi:ONのままスリープすると60mWになる。つまり 43mWの消費電力。これは「設定」→「電源とスリープ」→「PCがバッテリー電源を使用していてスリープ状態の場合は、ネットワークから切断します」が「常時」の時でもだ。WiFiはこまめにOFFにしよう。
* Edge:Edgeを開きっぱなし(ローカルのHTMLファイルを表示)でも30mWぐらい消費する。リモートサイトの開きっぱなしでは20mW。しかし、スリープさせとくことは作業状態を維持したいので、これは受け入れざるを得ない。
* chrome: 一方、Chromeは無罪に使い消費電力だった。
* 下で述べているアクセス表示ツールのDLWは10mWだった。許容しても良いか判断に迷う消費電力だ。
* Dropbox: 無罪
* OneDrive: 20mW。停止を推奨。


<div align="center"><img src="/images/2017-08-12-gpd-pocket-power-plan1.png" alt="powerplan"><img src="/images/2017-08-12-gpd-pocket-power-plan2.png" alt="powerplan"></div>

# キーボード、ポインタ
自宅ではUbuntu+Realforce(JIS配列、かな入力、Mozc、変換/無変換でIME ON/OFF)、有線Microsoft Mouse。勤務先ではLet's Note+Windows 7(JIS配列、ローマ字入力、MS-IME, Alt+漢字でIME ON/OFF')、ホイールパッド(ホイールスクロールやタップを無効)、という構成。

GPD Pocket の偽ASCII配列、Shift+CapsでIMEのON/OFFは慣れるのが大変。どうしても見ながらタイプになってしまう。キーのタッチは軽くてシャープでよいが、キーのエッジが多少ひっかかる。キー表面もざらっとしていて、私はツルッとしているのが好みだ。

AutoHotKey を使って、キー配列をカスタマイズした。
* `AppsKey::MButton` アプリケーションキー(スペースキーの右にある[三])をマウスのミドルボタンに割り当ててスクロールさせる。
* `RAlt::Send, {vkF3sc029}` 右ALTキーを、全角半角キーに割り当てて、IMEのON/OFFを右ALTキーで行う。
* `CapsLock::Tab`, `Tab::CapsLock` TABとCapsLockを入れ替える。本来、TABはQの左だが、Aの左のほうがまだマシ。コマンドラインの補完で使用頻度が高い。
* `Delete::Backspace`,`Backspace::Delete` BS と Del だとBSの方が使用頻度が高いので、電源キーより遠いところに配置する。そもそも、通常のキーボードでは、Enterの上はBS。

BSキーと電源が近接しているのは殺意を覚えることがしばしばある。

一方、ポインタは、かつてTrackPadを使っていたこともあって非常に快適。カーソルの設定を早めに変更しておくこと、これもネットで紹介されていた設定だが、メニューキーをマウススクロールに割り当てることで快適に使用できる。自宅での使用のためにBluetoothマウスを買ったが、無くても大丈夫なぐらい。標準ポインタでも十分使えるが、ネットで推奨されているThinkPadのロープロファイルポインタに変更すればさらに素晴らしい。ブームに便乗した小売店が高値を付けているが、補修部品をきちんと供給しているLenovoに敬意を示す意味でも、10個入りを正規ルートで購入するべきだろう。

# 周辺機器

## headset
3.5mmのヘッドホンジャックがある。電車の中などで動画を見る場合はヘッドホンが必要。付属のヘッドホン(3.5mmステレオ)はちゃんと動作するが、手持ちのヘッドセット(サンワサプライ製のCTIA規格、マイク+Talkスイッチ付き)を挿したらうまく動作しない。OMTP規格でバイアスが供給されている疑いが。→2017-08-11のサウンドドライバ更新で回復した。

## USB Type-C
充電専用？ 喜び勇んでType-C HUBを買ってみたが動作せず。PD HUBとしても動作しないし、バスパワーの普通のHUBとしても認識しない。外部デバイスの接続はType-A(複数必要ならHUB)、外部ディスプレイはMicroHDMIの変換コネクタ、入力インフェースはBluetoothが妥当だろう。

## ディスプレイ
1920×1200の解像度を誇るが7インチは老眼にはつらい。幸い、Windows10はディスプレイスケーリングが効果的なので150%の設定で使用中。実質1280×800だ。125%ではつらい。製品に保護シートが付属するが、Visaviの非光沢タイプを買った。非光沢アンチグレアが好きだし、形がピッタリで全く存在感を忘れる。

microHDMI-HDMK変換コネクタ、microUSB-TypeC 変換コネクタは安いし小さいので持っておくとよいだろう。

# Windows10
後述のとおり、Docker for Windowsを使いたいのでHomeからProにアップデートした。ストアで購入可能だ。

ほとんど、初Windows10。色々と新機能があって便利になっている。

## PowerShell
強力らしいし、歩み寄ろうとしてくれる努力も感じられるが、全くなじめない。デフォルトではビープがうるさくて、それを消すためには設定ファイルが必要で、設定ファイルを有効にするために権限変更が必要とはハードル高すぎるだろう。

## chocolaty
apt みたいなもの。登録されているアプリの場合、コマンド一発でインストール&アップデートできる。便利すぎる。そういったのを統一的に扱うためにPowerShell上のPackageManagementというのもあるらしいがうまく動かなかった。今回は知らずにインストールしたアプリが多いが、次は真っ先に chocolaty を入れて、cinstしまくる予定。

## Bash on Windows(Linux Subsystem for Windows)
クライアントLinux環境は、仮想PCではなく、ここに構築することにした。GUIアプリもXserverを立てればOK。全部apt-getで入る。
コマンドラインだけなら容量はあまり食わない。日本語入力はWindows側のIMEで可能なので、UTF-8の日本語ファイルの編集もVimなどで可能だ。
GUIアプリもXサーバ経由で使えるのでインストールした。Windows側のXserverはXmingが有名だがVcXsrv の方が近年の評価が高い。

## Docker for Windows
サーバ環境はDocker for Windowsを使ってみた。VirtualBoxでも動作可能だと思うが、今さらサーバをapt-getでバージョン管理したくないので。起動に時間がかかる。Docker for Windowsの性能か、Atom-ZのHyper-V性能が悪いのかは不明。ときどき不安定でDockerが死ぬことがあるが、一応は使えている。

VirtualBox とスリープの相性問題も報告されており、通常の仮想マシンを使うにしてもHyper-Vにというのもある。

## Python
Anaconda を入れた。

## Rust
公式に従って rustup-init.exe で入る。以後は rustup にお任せ。Windowsの場合は Visual C++ Build Tool を入れておく必要がある。

## Node.js
* Node.js を入れてその上にtextlint、VS Code で執筆環境はOK。

## その他
* DLWアクセスランプというタスクトレイでディスクとネットのアクセスをモニタ出来るツール。
* 純正ケースも購入。ピッタリなのが具合良い。


# 省電力設定

おかげで、だいぶ詳しくなった。

## powercfg

電源設定のフロントエンドとなっているのが powercfg.exe だ。

### 主要なオプションを表示する

```
C:\WINDOWS\system32>powercfg /help
```

### ウェイクアップタイマーの一覧を表示する

これらがあると、タイマーでスリープが解除されてしまうおそれがある。

```
C:\WINDOWS\system32>powercfg /waketimers
システムにアクティブなスリープ解除タイマーがありません。
```

### デバイスから起動するものたち

これらのデバイスはスリープを解除して起動してしまう。

```
C:\WINDOWS\system32>powercfg /devicequery wake_armed
HID 準拠マウス
HID キーボード デバイス (001)
```

ちなみに、可能性がある一覧をリストするのはこちら。個々のデバイスのプロパティから、このデバイスでスリープを解除するかどうかを設定できる。

```
C:\WINDOWS\system32>powercfg /devicequery wake_programmable
HID 準拠ベンダー定義デバイス
HID 準拠マウス
Realtek I2S Audio Codec
HID キーボード デバイス (001)
HID 準拠システム コントローラー (002)
HID 準拠コンシューマー制御デバイス (007)
HID 準拠ワイヤレス無線コントロール (001)
```

より詳しくは `powercfg /devicequery /?`。

## 何が動いているのか

`powercfg /sleepstudy`を実行すると、そのディレクトリに `sleepstudy-report.html`というレポートが生成される。中身は直近3日の稼働状況で、いつ・どのステートに・どれぐらいいたか・そのステートでの消費電力・バッテリー消費量などが一覧されている。詳細項目では、どのプログラムが稼働しているか・そのステートに入るきっかけとなったイベント、などが記されている。

これを見ながら詳細な設定を詰めていくことになる。

## レジストリの謎

省電力設定のほとんどは隠されていて、設定可能にするにはレジストリの編集が必要だ。
いわゆる、`\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Power\PowerSettings`の下の16進の文字列(GUID)だ。

### 一覧を取得

これらのキーが何を意味しているかの一覧は次のコマンドで取得できる。

```
C:\WINDOWS\system32>powercfg /aliases

a1841308-3541-4fab-bc81-f71556f20b4a  SCHEME_MAX
8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c  SCHEME_MIN
381b4222-f694-41f0-9685-ff5bb260df2e  SCHEME_BALANCED
e73a048d-bf27-4f12-9731-8b2076e8891f  SUB_BATTERY
637ea02f-bbcb-4015-8e2c-a1c7b9c0b546    BATACTIONCRIT
d8742dcb-3e6a-4b3c-b3fe-374623cdcf06    BATACTIONLOW
bcded951-187b-4d05-bccc-f7e51960c258    BATFLAGSLOW
9a66d8d7-4ff7-4ef9-b5a2-5a326ca2a469    BATLEVELCRIT
8183ba9a-e910-48da-8769-14ae6dc1170a    BATLEVELLOW
4f971e89-eebd-4455-a8de-9e59040e7347  SUB_BUTTONS
5ca83367-6e45-459f-a27b-476b1d01c936    LIDACTION
99ff10e7-23b1-4c07-a9d1-5c3206d741b4    LIDOPENWAKE
7648efa3-dd9c-4e3e-b566-50f929386280    PBUTTONACTION
96996bc0-ad50-47ec-923b-6f41874dd9eb    SBUTTONACTION
a7066653-8d6c-40a8-910e-a1f54b84c7e5    UIBUTTON_ACTION
0012ee47-9041-4b5d-9b77-535fba8b1442  SUB_DISK
6738e2c4-e8a5-4a42-b16a-e040e769756e    DISKIDLE
48672f38-7a9a-4bb2-8bf8-3d85be19de4e  SUB_INTSTEER
2e601130-5351-4d9d-8e04-252966bad054  SUB_IR
c36f0eb4-2988-4a70-8eee-0884fc2c2433    COALTIME
fea3413e-7e05-4911-9a71-700331f1c294  SUB_NONE
501a4d13-42af-4429-9fd1-a8218c268e20  SUB_PCIEXPRESS
ee12f906-d277-404b-b6da-e5fa1a576df5    ASPM
8619b916-e004-4dd8-9b66-dae86f806698  SUB_PRESENCE
54533251-82be-4824-96c1-47b60b740d00  SUB_PROCESSOR
75b0ae3f-bce0-45a7-8c89-c9611c25e100    PROCFREQMAX
bc5038f7-23e0-4960-96da-33abaf5935ec    PROCTHROTTLEMAX
893dee8e-2bef-41e0-89c6-b55d0929964c    PROCTHROTTLEMIN
94d3a615-a899-4ac5-ae2b-e4d8f634367f    SYSCOOLPOL
238c9fa8-0aad-41ed-83f4-97be242c8f20  SUB_SLEEP
9d7815a6-7ee4-497e-8888-515a05f02364    HIBERNATEIDLE
94ac6d29-73ce-41a6-809f-6363ba21b47e    HYBRIDSLEEP
bd3b718a-0680-4d9d-8ab2-e1d2b4ac806d    RTCWAKE
29f6c1db-86da-48c5-9fdb-f2b67b1f44da    STANDBYIDLE
7516b95f-f776-4464-8c53-06167f40cc99  SUB_VIDEO
fbd9aa66-9553-4097-ba44-ed6e9d65eab8    ADAPTBRIGHT
3c0bc021-c8a8-4e07-a973-6b14cbcb2b7e    VIDEOIDLE
```

だいぶわかりやすくなってきた。

### 電源プランの一覧

```
C:\WINDOWS\system32>powercfg /l

既存の電源設定 (* アクティブ)
-----------------------------------
電源設定の GUID: 381b4222-f694-41f0-9685-ff5bb260df2e  (バランス) *
```

### 電源プランに設定されている内容

次のコマンドで、その電源プランに設定されている内容を「フルに」表示させることができる。ここで日本語表示とGUIDの完全な対応が得られる。求めるものは、次のGUIDなので、あとはレジストリエディタで編集すればよい。Attributes=2 にすれば設定項目が現れる。

サブグループの GUID: 238c9fa8-0aad-41ed-83f4-97be242c8f20  (スリープ)の下の
電源設定の GUID: bd3b718a-0680-4d9d-8ab2-e1d2b4ac806d  (スリープ解除タイマーの許可)

```
C:\WINDOWS\system32>powercfg /q  381b4222-f694-41f0-9685-ff5bb260df2e
電源設定の GUID: 381b4222-f694-41f0-9685-ff5bb260df2e  (バランス)
  GUID エイリアス: SCHEME_BALANCED
  サブグループの GUID: 0012ee47-9041-4b5d-9b77-535fba8b1442  (ハード ディスク)
    GUID エイリアス: SUB_DISK
    電源設定の GUID: 6738e2c4-e8a5-4a42-b16a-e040e769756e  (次の時間が経過後ハード ディスクの電源を切る)
      GUID エイリアス: DISKIDLE
      利用可能な設定の最小値: 0x00000000
      利用可能な設定の最大値: 0xffffffff
      利用可能な設定の増分: 0x00000001
      利用可能な設定の単位: 秒
    現在の AC 電源設定のインデックス: 0x0000001e
    現在の DC 電源設定のインデックス: 0x0000001e

  サブグループの GUID: 02f815b5-a5cf-4c84-bf20-649d1f75d3d8  (Internet Explorer)
    電源設定の GUID: 4c793e7d-a264-42e1-87d3-7a0d2f523ccd  (JavaScript タイマーの間隔)
      利用可能な設定のインデックス: 000
      利用可能な設定のフレンドリ名: 最大限の省電力
      利用可能な設定のインデックス: 001
      利用可能な設定のフレンドリ名: 最大パフォーマンス
    現在の AC 電源設定のインデックス: 0x00000001
    現在の DC 電源設定のインデックス: 0x00000000

  サブグループの GUID: 0d7dbae2-4294-402a-ba8e-26777e8488cd  (デスクトップの背景の設定)
    電源設定の GUID: 309dce9b-bef4-4119-9921-a851fb12f0f4  (スライド ショー)
      利用可能な設定のインデックス: 000
      利用可能な設定のフレンドリ名: 有効
      利用可能な設定のインデックス: 001
      利用可能な設定のフレンドリ名: 一時停止
    現在の AC 電源設定のインデックス: 0x00000000
    現在の DC 電源設定のインデックス: 0x00000000

  サブグループの GUID: 19cbb8fa-5279-450e-9fac-8a3d5fedd0c1  (ワイヤレス アダプターの設定)
    電源設定の GUID: 12bbebe6-58d6-4636-95bb-3217ef867c1a  (省電力モード)
      利用可能な設定のインデックス: 000
      利用可能な設定のフレンドリ名: 最大パフォーマンス
      利用可能な設定のインデックス: 001
      利用可能な設定のフレンドリ名: 省電力 (低)
      利用可能な設定のインデックス: 002
      利用可能な設定のフレンドリ名: 省電力 (中)
      利用可能な設定のインデックス: 003
      利用可能な設定のフレンドリ名: 省電力 (高)
    現在の AC 電源設定のインデックス: 0x00000000
    現在の DC 電源設定のインデックス: 0x00000002

  サブグループの GUID: 238c9fa8-0aad-41ed-83f4-97be242c8f20  (スリープ)
    GUID エイリアス: SUB_SLEEP
    電源設定の GUID: 29f6c1db-86da-48c5-9fdb-f2b67b1f44da  (次の時間が経過後スリープする)
      GUID エイリアス: STANDBYIDLE
      利用可能な設定の最小値: 0x00000000
      利用可能な設定の最大値: 0xffffffff
      利用可能な設定の増分: 0x00000001
      利用可能な設定の単位: 秒
    現在の AC 電源設定のインデックス: 0x00000258
    現在の DC 電源設定のインデックス: 0x000000f0

    電源設定の GUID: 94ac6d29-73ce-41a6-809f-6363ba21b47e  (ハイブリッド スリープを許可する)
      GUID エイリアス: HYBRIDSLEEP
      利用可能な設定のインデックス: 000
      利用可能な設定のフレンドリ名: オフ
      利用可能な設定のインデックス: 001
      利用可能な設定のフレンドリ名: オン
    現在の AC 電源設定のインデックス: 0x00000001
    現在の DC 電源設定のインデックス: 0x00000001

    電源設定の GUID: 9d7815a6-7ee4-497e-8888-515a05f02364  (次の時間が経過後休止状態にする)
      GUID エイリアス: HIBERNATEIDLE
      利用可能な設定の最小値: 0x00000000
      利用可能な設定の最大値: 0xffffffff
      利用可能な設定の増分: 0x00000001
      利用可能な設定の単位: 秒
    現在の AC 電源設定のインデックス: 0x00000000
    現在の DC 電源設定のインデックス: 0x00000000

    電源設定の GUID: bd3b718a-0680-4d9d-8ab2-e1d2b4ac806d  (スリープ解除タイマーの許可)
      GUID エイリアス: RTCWAKE
      利用可能な設定のインデックス: 000
      利用可能な設定のフレンドリ名: 無効
      利用可能な設定のインデックス: 001
      利用可能な設定のフレンドリ名: 有効
      利用可能な設定のインデックス: 002
      利用可能な設定のフレンドリ名: 重要なスリープ解除タイマーのみ
    現在の AC 電源設定のインデックス: 0x00000002
    現在の DC 電源設定のインデックス: 0x00000000

  サブグループの GUID: 2a737441-1930-4402-8d77-b2bebba308a3  (USB 設定)
    電源設定の GUID: 48e6b7a6-50f5-4782-a5d4-53bb8f07e226  (USB のセレクティブ サスペンドの設定)
      利用可能な設定のインデックス: 000
      利用可能な設定のフレンドリ名: 無効
      利用可能な設定のインデックス: 001
      利用可能な設定のフレンドリ名: 有効
    現在の AC 電源設定のインデックス: 0x00000001
    現在の DC 電源設定のインデックス: 0x00000001

  サブグループの GUID: 2e601130-5351-4d9d-8e04-252966bad054  (アイドル回復性)
    GUID エイリアス: SUB_IR
    電源設定の GUID: c36f0eb4-2988-4a70-8eee-0884fc2c2433  (IO 一体化のタイムアウト)
      GUID エイリアス: COALTIME
      利用可能な設定の最小値: 0x00000000
      利用可能な設定の最大値: 0xffffffff
      利用可能な設定の増分: 0x00000001
      利用可能な設定の単位: ミリ秒
    現在の AC 電源設定のインデックス: 0x00000000
    現在の DC 電源設定のインデックス: 0x00000000

  サブグループの GUID: 44f3beca-a7c0-460e-9df2-bb8b99e0cba6  (Intel(R) Graphics Settings)
    電源設定の GUID: 3619c3f2-afb2-4afc-b0e9-e7fef372de36  (Intel(R) Graphics Power Plan)
      利用可能な設定のインデックス: 000
      利用可能な設定のフレンドリ名: Maximum Battery Life
      利用可能な設定のインデックス: 001
      利用可能な設定のフレンドリ名: Balanced
      利用可能な設定のインデックス: 002
      利用可能な設定のフレンドリ名: Maximum Performance
    現在の AC 電源設定のインデックス: 0x00000001
    現在の DC 電源設定のインデックス: 0x00000001

  サブグループの GUID: 4f971e89-eebd-4455-a8de-9e59040e7347  (電源ボタンとカバー)
    GUID エイリアス: SUB_BUTTONS
    電源設定の GUID: 5ca83367-6e45-459f-a27b-476b1d01c936  (カバーを閉じたときの操作)
      GUID エイリアス: LIDACTION
      利用可能な設定のインデックス: 000
      利用可能な設定のフレンドリ名: 何もしない
      利用可能な設定のインデックス: 001
      利用可能な設定のフレンドリ名: スリープ
      利用可能な設定のインデックス: 002
      利用可能な設定のフレンドリ名: 休止状態
      利用可能な設定のインデックス: 003
      利用可能な設定のフレンドリ名: シャットダウン
    現在の AC 電源設定のインデックス: 0x00000001
    現在の DC 電源設定のインデックス: 0x00000001

    電源設定の GUID: 7648efa3-dd9c-4e3e-b566-50f929386280  (電源ボタンの操作)
      GUID エイリアス: PBUTTONACTION
      利用可能な設定のインデックス: 000
      利用可能な設定のフレンドリ名: 何もしない
      利用可能な設定のインデックス: 001
      利用可能な設定のフレンドリ名: スリープ
      利用可能な設定のインデックス: 002
      利用可能な設定のフレンドリ名: 休止状態
      利用可能な設定のインデックス: 003
      利用可能な設定のフレンドリ名: シャットダウン
      利用可能な設定のインデックス: 004
      利用可能な設定のフレンドリ名: ディスプレイの電源を切る
    現在の AC 電源設定のインデックス: 0x00000001
    現在の DC 電源設定のインデックス: 0x00000001

    電源設定の GUID: 96996bc0-ad50-47ec-923b-6f41874dd9eb  (スリープ ボタンの操作)
      GUID エイリアス: SBUTTONACTION
      利用可能な設定のインデックス: 000
      利用可能な設定のフレンドリ名: 何もしない
      利用可能な設定のインデックス: 001
      利用可能な設定のフレンドリ名: スリープ
      利用可能な設定のインデックス: 002
      利用可能な設定のフレンドリ名: 休止状態
      利用可能な設定のインデックス: 003
      利用可能な設定のフレンドリ名: シャットダウン
      利用可能な設定のインデックス: 004
      利用可能な設定のフレンドリ名: ディスプレイの電源を切る
    現在の AC 電源設定のインデックス: 0x00000000
    現在の DC 電源設定のインデックス: 0x00000000

    電源設定の GUID: 99ff10e7-23b1-4c07-a9d1-5c3206d741b4  (カバーを開いたときのアクション)
      GUID エイリアス: LIDOPENWAKE
      利用可能な設定のインデックス: 000
      利用可能な設定のフレンドリ名: 何もしない
      利用可能な設定のインデックス: 001
      利用可能な設定のフレンドリ名: 画面をオンにする
    現在の AC 電源設定のインデックス: 0x00000000
    現在の DC 電源設定のインデックス: 0x00000000

    電源設定の GUID: a7066653-8d6c-40a8-910e-a1f54b84c7e5  ([スタート] メニューの電源ボタンの操作)
      GUID エイリアス: UIBUTTON_ACTION
      利用可能な設定のインデックス: 000
      利用可能な設定のフレンドリ名: スリープ
      利用可能な設定のインデックス: 001
      利用可能な設定のフレンドリ名: 休止状態
      利用可能な設定のインデックス: 002
      利用可能な設定のフレンドリ名: シャットダウン
    現在の AC 電源設定のインデックス: 0x00000000
    現在の DC 電源設定のインデックス: 0x00000000

  サブグループの GUID: 501a4d13-42af-4429-9fd1-a8218c268e20  (PCI Express)
    GUID エイリアス: SUB_PCIEXPRESS
    電源設定の GUID: ee12f906-d277-404b-b6da-e5fa1a576df5  (リンク状態の電源管理)
      GUID エイリアス: ASPM
      利用可能な設定のインデックス: 000
      利用可能な設定のフレンドリ名: オフ
      利用可能な設定のインデックス: 001
      利用可能な設定のフレンドリ名: 適切な省電力
      利用可能な設定のインデックス: 002
      利用可能な設定のフレンドリ名: 最大限の省電力
    現在の AC 電源設定のインデックス: 0x00000002
    現在の DC 電源設定のインデックス: 0x00000002

  サブグループの GUID: 54533251-82be-4824-96c1-47b60b740d00  (プロセッサの電源管理)
    GUID エイリアス: SUB_PROCESSOR
    電源設定の GUID: 75b0ae3f-bce0-45a7-8c89-c9611c25e100  (プロセッサの最大周波数)
      GUID エイリアス: PROCFREQMAX
      利用可能な設定の最小値: 0x00000000
      利用可能な設定の最大値: 0xffffffff
      利用可能な設定の増分: 0x00000001
      利用可能な設定の単位: MHz
    現在の AC 電源設定のインデックス: 0x00000000
    現在の DC 電源設定のインデックス: 0x00000000

    電源設定の GUID: 893dee8e-2bef-41e0-89c6-b55d0929964c  (最小のプロセッサの状態)
      GUID エイリアス: PROCTHROTTLEMIN
      利用可能な設定の最小値: 0x00000000
      利用可能な設定の最大値: 0x00000064
      利用可能な設定の増分: 0x00000001
      利用可能な設定の単位: %
    現在の AC 電源設定のインデックス: 0x00000005
    現在の DC 電源設定のインデックス: 0x00000005

    電源設定の GUID: 94d3a615-a899-4ac5-ae2b-e4d8f634367f  (システムの冷却ポリシー)
      GUID エイリアス: SYSCOOLPOL
      利用可能な設定のインデックス: 000
      利用可能な設定のフレンドリ名: パッシブ
      利用可能な設定のインデックス: 001
      利用可能な設定のフレンドリ名: アクティブ
    現在の AC 電源設定のインデックス: 0x00000001
    現在の DC 電源設定のインデックス: 0x00000000

    電源設定の GUID: bc5038f7-23e0-4960-96da-33abaf5935ec  (最大のプロセッサの状態)
      GUID エイリアス: PROCTHROTTLEMAX
      利用可能な設定の最小値: 0x00000000
      利用可能な設定の最大値: 0x00000064
      利用可能な設定の増分: 0x00000001
      利用可能な設定の単位: %
    現在の AC 電源設定のインデックス: 0x00000064
    現在の DC 電源設定のインデックス: 0x00000064

  サブグループの GUID: 7516b95f-f776-4464-8c53-06167f40cc99  (ディスプレイ)
    GUID エイリアス: SUB_VIDEO
    電源設定の GUID: 3c0bc021-c8a8-4e07-a973-6b14cbcb2b7e  (次の時間が経過後ディスプレイの電源を切る)
      GUID エイリアス: VIDEOIDLE
      利用可能な設定の最小値: 0x00000000
      利用可能な設定の最大値: 0xffffffff
      利用可能な設定の増分: 0x00000001
      利用可能な設定の単位: 秒
    現在の AC 電源設定のインデックス: 0x00000258
    現在の DC 電源設定のインデックス: 0x000000f0

    電源設定の GUID: aded5e82-b909-4619-9949-f5d71dac0bcb  (ディスプレイの明るさ)
      利用可能な設定の最小値: 0x00000000
      利用可能な設定の最大値: 0x00000064
      利用可能な設定の増分: 0x00000001
      利用可能な設定の単位: %
    現在の AC 電源設定のインデックス: 0x00000064
    現在の DC 電源設定のインデックス: 0x00000028

    電源設定の GUID: f1fbfde2-a960-4165-9f88-50667911ce96  (ディスプレイ暗転時の明るさ)
      利用可能な設定の最小値: 0x00000000
      利用可能な設定の最大値: 0x00000064
      利用可能な設定の増分: 0x00000001
      利用可能な設定の単位: %
    現在の AC 電源設定のインデックス: 0x00000032
    現在の DC 電源設定のインデックス: 0x00000032

    電源設定の GUID: fbd9aa66-9553-4097-ba44-ed6e9d65eab8  (自動輝度調整を有効にする)
      GUID エイリアス: ADAPTBRIGHT
      利用可能な設定のインデックス: 000
      利用可能な設定のフレンドリ名: オフ
      利用可能な設定のインデックス: 001
      利用可能な設定のフレンドリ名: オン
    現在の AC 電源設定のインデックス: 0x00000000
    現在の DC 電源設定のインデックス: 0x00000000

  サブグループの GUID: 9596fb26-9850-41fd-ac3e-f7c3c00afd4b  (マルチメディアの設定)
    電源設定の GUID: 03680956-93bc-4294-bba6-4e0f09bb717f  (メディア共有時)
      利用可能な設定のインデックス: 000
      利用可能な設定のフレンドリ名: コンピューターのスリープを許可する
      利用可能な設定のインデックス: 001
      利用可能な設定のフレンドリ名: アイドリングがスリープ状態になるのを回避する
      利用可能な設定のインデックス: 002
      利用可能な設定のフレンドリ名: コンピューターが退席中モードになるのを許可する
    現在の AC 電源設定のインデックス: 0x00000001
    現在の DC 電源設定のインデックス: 0x00000000

    電源設定の GUID: 10778347-1370-4ee0-8bbd-33bdacaade49  (Video playback quality bias.)
      利用可能な設定のインデックス: 000
      利用可能な設定のフレンドリ名: Video playback power-saving bias.
      利用可能な設定のインデックス: 001
      利用可能な設定のフレンドリ名: Video playback performance bias.
    現在の AC 電源設定のインデックス: 0x00000001
    現在の DC 電源設定のインデックス: 0x00000000

    電源設定の GUID: 34c7b99f-9a6d-4b3c-8dc7-b6693b78cef4  (ビデオの再生時)
      利用可能な設定のインデックス: 000
      利用可能な設定のフレンドリ名: ビデオ品質の最適化
      利用可能な設定のインデックス: 001
      利用可能な設定のフレンドリ名: バランス
      利用可能な設定のインデックス: 002
      利用可能な設定のフレンドリ名: 省電力の最適化
    現在の AC 電源設定のインデックス: 0x00000000
    現在の DC 電源設定のインデックス: 0x00000001

  サブグループの GUID: e73a048d-bf27-4f12-9731-8b2076e8891f  (バッテリ)
    GUID エイリアス: SUB_BATTERY
    電源設定の GUID: 637ea02f-bbcb-4015-8e2c-a1c7b9c0b546  (バッテリ切れの動作)
      GUID エイリアス: BATACTIONCRIT
      利用可能な設定のインデックス: 000
      利用可能な設定のフレンドリ名: 何もしない
      利用可能な設定のインデックス: 001
      利用可能な設定のフレンドリ名: スリープ
      利用可能な設定のインデックス: 002
      利用可能な設定のフレンドリ名: 休止状態
      利用可能な設定のインデックス: 003
      利用可能な設定のフレンドリ名: シャットダウン
    現在の AC 電源設定のインデックス: 0x00000003
    現在の DC 電源設定のインデックス: 0x00000003

    電源設定の GUID: 8183ba9a-e910-48da-8769-14ae6dc1170a  (低残量バッテリのレベル)
      GUID エイリアス: BATLEVELLOW
      利用可能な設定の最小値: 0x00000000
      利用可能な設定の最大値: 0x00000064
      利用可能な設定の増分: 0x00000001
      利用可能な設定の単位: %
    現在の AC 電源設定のインデックス: 0x0000000f
    現在の DC 電源設定のインデックス: 0x0000000f

    電源設定の GUID: 9a66d8d7-4ff7-4ef9-b5a2-5a326ca2a469  (バッテリ切れのレベル)
      GUID エイリアス: BATLEVELCRIT
      利用可能な設定の最小値: 0x00000000
      利用可能な設定の最大値: 0x00000064
      利用可能な設定の増分: 0x00000001
      利用可能な設定の単位: %
    現在の AC 電源設定のインデックス: 0x00000006
    現在の DC 電源設定のインデックス: 0x00000006

    電源設定の GUID: bcded951-187b-4d05-bccc-f7e51960c258  (低残量バッテリの通知)
      GUID エイリアス: BATFLAGSLOW
      利用可能な設定のインデックス: 000
      利用可能な設定のフレンドリ名: オフ
      利用可能な設定のインデックス: 001
      利用可能な設定のフレンドリ名: オン
    現在の AC 電源設定のインデックス: 0x00000001
    現在の DC 電源設定のインデックス: 0x00000001

    電源設定の GUID: d8742dcb-3e6a-4b3c-b3fe-374623cdcf06  (低残量バッテリの動作)
      GUID エイリアス: BATACTIONLOW
      利用可能な設定のインデックス: 000
      利用可能な設定のフレンドリ名: 何もしない
      利用可能な設定のインデックス: 001
      利用可能な設定のフレンドリ名: スリープ
      利用可能な設定のインデックス: 002
      利用可能な設定のフレンドリ名: 休止状態
      利用可能な設定のインデックス: 003
      利用可能な設定のフレンドリ名: シャットダウン
    現在の AC 電源設定のインデックス: 0x00000000
    現在の DC 電源設定のインデックス: 0x00000000

    電源設定の GUID: f3c5027d-cd16-4930-aa6b-90db844a8f00  (省電源移行バッテリ レベル)
      利用可能な設定の最小値: 0x00000000
      利用可能な設定の最大値: 0x00000064
      利用可能な設定の増分: 0x00000001
      利用可能な設定の単位: %
    現在の AC 電源設定のインデックス: 0x00000004
    現在の DC 電源設定のインデックス: 0x00000004
```

